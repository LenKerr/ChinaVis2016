<!DOCTYPE html>
<html>
<title>ChinaVis2016</title>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <link type="text/css" rel ="stylesheet" href="../static/css/bootstrap.min.css">
    <script type="text/javascript" src="../static/jquery-1.12.3.min.js"></script>
    <script type="text/javascript" src="../static/vis.js"></script>
    <link type="text/css" rel="stylesheet" href="../static/vis.css">
    <script src="../static/net10to10New.js"></script>
    <script src="../static/googleAnalytics.js"></script>
    <script type="text/javascript" src="../static/d3.min.js"></script>
    <style type="text/css">
       header,footer,nav,section,aside,article,p,table {
            border:1px dotted black;
            border-radius: 5px;
        }
        a, a:hover{
            text-decoration: none;
        }

        #mynetwork{
            height: 600px;
            border: 1px solid lightgray;
        }

        #vcpview,#flowview,#vcptime,#serverview{
            border: 1px solid lightgray;
        }

    </style>
</head>
<body>
<ul class ="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="#" class="navbar-brand">
                <span class="glyphicon glyphicon-indent-right"></span>
            </a>
            <button class="navbar-toggle" data-toggle="collapse" data-target="#divNav">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <div id = "divNav" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="#bignetwork">BigBusiness Network</a></li>
                <li><a href="#nodetype">Net Nodes' types</a></li>
                <li><a href="#routesituation">VCPs' situations</a></li>
                <li><a href="#vcpstock">VCPs' view</a></li>
                <li >
                    <input type ="text" id="ipsearch" style="margin-top: 10px">
                    <button class="btn btn-primary" onclick="searchip()">
                        <span class="glyphicon glyphicon-search">&nbsp; ip 查询</span>
                    </button>
                </li>

            </ul>
        </div>
    </div>
</ul>
<div style="margin-top:51px"></div>
<div class="container">
        <div class = "row">
            <h2 id = "bignetwork">BigBusiness Network</h2>
             <div id = "mynetwork" class = "col-md-12" ></div>
        </div>
        <div class="row">
            <div id="legend" class = "col-md-12">
                 <h2 id = "nodetype">Net Nodes' types</h2>
                <span class="glyphicon glyphicon-king"> Net Node Type&nbsp;</span>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" style="background-color:rgb(210,229,255)"
                            onclick = "highlightgroup(1)">ftpServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(255,255,163)"
                            onclick = "highlightgroup(2)">smtpServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(255,175,177)"
                            onclick = "highlightgroup(3)">dnsServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(128,187,93)"
                            onclick = "highlightgroup(4)">dbServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(240,179,245)"
                            onclick = "highlightgroup(5)">httpServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(173,133,228)"
                            onclick = "highlightgroup(6)">fileServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(255,168,7)"
                            onclick = "highlightgroup(7)">unkServer</button>
                    <button type="button" class="btn btn-default" style="background-color:rgb(82,61,252);
                    color:rgb(255,255,255)" onclick = "highlightgroup(8)">route</button>
                </div>
            </div>
        </div>
        <div class="row" style="margin-top: 10px">

            <div id="vpc" class = "col-md-12">

                <h2 id = "routesituation">VCPs' situations</h2>
                <span class="glyphicon glyphicon-queen"> VPI1 VCI1 Type&nbsp;&nbsp;</span>
                <div class="btn-group" role="group">
                    <div class="row">

                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,0,[13,38,43,45,56,283,284,287,288,291,361,485,572,651])">0 &amp; 0</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,37,[0,3,4,5,6,36,42,51,52,56,62,65,70,80,82,84,104,114,131,144,147,158,169,174,181,207,208,211,213,215,216,217,239,259,261,274,314,315,333,339,383,385,460,469,472,485,493,494,495,505,519,522,527,542,555,559,572,590,594,595,606,607,608,610,614,645,655,658,679,682,700,722])">0 &amp; 37</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,38,[34,36,41,485])">0 &amp; 38</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,42,[8,10,11,12,13,14,16,17,19,21,23,24,27,28,38,43,45,50,56,73,74,75,76,78,79,129,140,180,200,201,202,204,205,269,279,280,283,284,287,288,291,309,317,323,336,361,381,387,413,415,452,453,485,490,500,567,568,642,651,703,705,715])">0 &amp; 42</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,49,[0,3,5,6,27,30,34,35,36,37,39,40,41,42,44,48,49,51,52,53,56,57,58,59,60,61,62,65,70,71,77,80,82,83,84,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,112,113,114,115,118,119,120,121,122,123,124,125,126,127,130,131,132,133,136,142,143,144,145,146,147,148,151,152,153,154,157,158,159,160,161,162,163,169,171,172,173,174,175,176,177,178,179,181,186,189,190,191,192,193,194,196,199,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,232,233,235,236,239,245,246,249,250,253,254,255,258,259,260,261,262,263,264,265,271,272,273,274,275,276,277,278,296,298,299,301,302,303,308,312,313,314,315,318,320,322,327,328,331,332,333,338,339,344,345,346,347,349,354,356,358,365,377,378,379,382,383,384,385,386,393,398,400,401,402,404,412,433,435,436,437,438,439,442,443,444,445,457,458,459,460,461,463,466,468,469,470,471,472,475,485,486,487,493,494,495,496,498,504,505,511,512,513,515,519,520,521,522,524,525,526,527,528,529,531,533,536,540,541,542,543,544,545,546,547,552,555,556,559,564,566,570,571,572,573,576,577,581,584,585,586,587,588,590,592,594,595,602,605,606,607,608,609,610,611,612,613,614,616,617,618,624,625,627,629,630,631,632,635,641,643,645,653,654,655,657,658,659,662,678,679,680,681,682,685,688,693,695,698,699,700,701,707,709,710,711,712,713,716,719,721,722])">0 &amp; 49</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,94,[0,3,4,5,6,34,35,36,41,42,51,52,53,56,57,58,60,61,62,65,66,67,68,69,70,71,72,77,80,81,82,84,85,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,113,114,115,118,119,120,122,123,124,125,126,128,130,131,132,133,134,138,139,141,142,143,144,145,146,147,148,151,152,153,154,157,158,159,160,161,162,163,169,171,172,173,174,175,176,177,178,179,181,186,189,191,192,193,194,196,199,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,223,237,253,258,259,260,261,262,263,272,273,274,275,276,277,298,312,313,314,315,320,327,328,329,330,332,333,339,344,345,346,347,365,377,378,382,383,384,385,386,393,398,401,402,433,435,436,438,442,443,444,445,457,458,459,460,461,469,470,472,475,476,477,478,479,480,481,482,485,486,493,494,495,496,503,505,512,514,519,520,521,522,523,524,525,527,529,536,540,541,542,543,544,546,547,554,555,559,571,572,573,581,584,587,590,591,592,593,594,595,602,606,607,608,609,610,611,612,613,614,616,617,624,625,627,629,630,631,632,636,637,638,639,640,641,645,653,654,655,658,659,671,672,673,678,679,680,681,682,698,699,700,701,709,712,713,721,722])">0 &amp; 94</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,100,[0,2,3,4,5,6,22,25,27,29,30,34,35,36,37,38,39,40,41,42,43,44,45,48,49,50,51,52,53,54,56,57,58,60,61,62,63,65,66,67,68,69,70,71,72,77,80,81,82,83,84,85,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,118,119,120,121,122,123,124,125,126,127,128,130,131,132,133,134,136,138,139,141,142,143,144,145,146,147,148,150,151,152,153,154,157,158,159,160,161,162,163,169,171,172,173,174,175,176,177,178,179,181,186,189,190,191,192,193,194,196,199,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,227,232,233,234,235,236,237,238,239,241,243,244,245,246,247,249,253,254,255,256,257,258,259,260,261,262,263,264,265,266,270,271,272,273,274,275,276,277,278,287,291,295,296,298,299,300,301,302,303,304,305,306,307,308,310,311,312,313,314,315,316,318,319,320,321,322,327,328,329,330,331,332,333,334,335,337,338,339,343,344,345,346,347,349,352,356,358,359,360,362,363,365,374,377,378,379,382,383,384,385,386,389,390,391,392,393,397,398,399,400,401,402,403,404,406,407,408,411,412,414,420,421,422,423,424,425,426,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,447,448,449,454,457,458,459,460,461,462,463,466,469,470,471,472,473,474,475,476,477,478,479,480,481,482,484,485,486,487,488,491,492,493,494,495,496,498,499,503,505,506,507,509,510,511,512,513,514,515,518,519,520,521,522,523,524,525,526,527,528,529,530,531,533,534,536,537,538,540,541,542,543,544,545,546,547,549,550,551,553,554,555,556,557,559,560,562,564,566,570,571,572,573,574,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,621,622,623,624,625,627,629,630,631,632,635,636,637,638,639,640,641,643,645,646,652,653,654,655,656,657,658,659,660,661,662,668,669,670,671,674,676,677,678,679,680,681,682,683,685,686,688,691,692,693,694,695,696,697,698,699,700,701,702,707,708,709,710,711,712,713,714,716,719,721,722,723,724,725])">0 &amp; 100</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,135,[1,31,32,33,46,47,55,86,87,89,90,91,92,116,117,135,149,155,156,164,165,166,167,170,182,183,185,188,195,197,198,224,226,230,248,267,268,285,286,289,292,293,294,297,325,326,341,350,355,364,366,367,372,373,380,388,394,395,416,417,418,428,450,451,464,465,508,517,561,568,575,626,628,633,634,647,648,649,664,665,666,675,717])">0 &amp; 135</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,153,[1,31,32,33,46,47,55,86,87,88,89,90,91,92,155,156,166,167,182,183,185,187,188,195,197,267,268,285,286,289,292,293,297,326,350,355,364,366,373,380,394,395,416,417,418,428,429,451,464,508,517,561,568,575,626,628,633,634,647,648,649,664,665,666,704,717])">0 &amp; 153</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,159,[1,31,32,33,46,47,55,64,86,87,88,89,90,91,92,116,117,135,137,149,155,156,164,165,166,167,170,182,183,184,185,187,188,195,197,198,224,226,230,248,267,268,285,286,289,292,293,294,297,325,326,341,350,355,364,366,367,369,371,372,373,380,388,394,395,409,416,417,418,427,428,429,446,450,451,464,465,508,516,517,532,535,561,568,575,620,626,628,633,634,647,648,649,664,665,666,675,704,718])">0 &amp; 159</button>
                    <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,179,[0,2,3,4,5,6,27,30,34,35,36,37,39,40,41,42,44,48,49,51,52,53,54,56,57,58,60,61,62,63,65,70,71,77,80,81,82,83,84,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,112,113,114,115,118,119,120,121,122,123,124,125,126,127,128,130,131,132,133,136,142,143,144,145,146,147,148,150,151,152,153,154,157,158,159,160,161,162,163,169,171,172,173,174,175,176,177,178,179,181,186,189,190,191,192,193,194,196,199,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,223,227,233,235,236,237,238,239,241,243,245,246,247,249,250,253,254,255,256,257,258,259,260,261,262,263,264,265,266,270,271,272,273,274,275,276,277,278,295,296,298,299,300,301,302,303,304,305,306,307,312,313,314,315,316,318,319,320,327,328,329,330,331,332,333,334,337,338,339,343,344,345,346,347,349,352,354,356,358,359,360,362,365,378,379,382,383,384,385,386,389,391,392,393,397,398,399,400,401,402,403,404,406,407,408,411,412,414,420,421,422,423,424,425,430,432,433,434,435,436,437,438,439,440,441,442,443,444,445,447,449,454,457,458,459,460,461,462,463,466,468,469,470,471,472,473,474,475,484,485,486,487,488,492,493,494,495,496,498,499,502,503,504,505,506,507,509,510,511,512,515,518,519,520,521,522,523,524,525,526,527,528,529,531,533,534,536,537,540,541,542,543,544,545,546,547,549,550,553,554,555,557,559,560,562,564,565,566,570,571,572,573,574,576,577,578,580,581,583,584,585,586,587,588,590,592,594,595,597,598,600,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,624,625,627,629,630,631,632,641,643,645,652,653,654,655,656,657,658,659,660,661,662,663,670,671,676,677,678,679,680,681,682,683,685,686,691,693,695,697,698,699,700,701,707,709,710,711,712,713,714,721,722,723,724])">0 &amp; 179</button>
                    </div>
                    <div class="row">

                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,543,[0,2,3,5,6,12,27,30,34,35,36,37,39,40,41,42,44,48,49,51,52,53,54,56,57,58,60,61,62,63,65,70,71,77,80,81,82,83,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,112,113,114,115,118,119,120,121,122,123,124,125,126,127,128,130,131,132,133,136,142,143,144,145,146,147,148,150,151,152,153,154,157,158,159,160,161,162,163,169,171,172,173,174,175,176,177,178,179,181,186,189,190,191,192,193,194,196,199,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,227,232,233,234,236,237,238,239,241,245,247,250,253,256,257,258,259,260,261,262,263,264,265,266,271,272,273,274,275,276,277,296,298,299,305,306,312,313,314,315,316,318,320,327,328,329,330,331,332,333,337,338,339,344,345,346,347,354,356,358,360,362,363,365,378,379,382,383,384,385,386,389,391,392,393,397,398,400,401,402,404,406,407,408,412,414,422,424,425,426,430,433,435,436,437,438,439,440,442,443,444,445,447,454,457,458,459,460,461,462,463,466,468,469,470,471,472,473,475,484,485,486,487,488,493,494,495,496,498,502,504,505,507,512,513,519,520,521,522,524,525,526,527,528,529,531,533,534,536,540,541,542,543,544,545,546,547,549,554,555,557,559,560,562,564,571,572,573,574,576,577,580,581,582,583,584,587,588,590,594,595,597,602,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,624,625,627,629,630,631,632,643,645,653,654,655,657,658,659,671,674,676,678,679,680,681,682,683,691,693,698,699,700,701,702,707,709,710,711,712,713,719,721,722,725])">0 &amp; 543</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,1174,[0,2,3,4,5,6,7,11,12,13,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,34,35,36,37,39,40,41,42,44,48,49,51,52,53,54,56,57,58,59,60,61,62,63,65,66,67,68,69,70,71,72,77,80,81,82,83,84,85,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,118,119,120,121,122,123,124,125,126,127,128,130,131,132,133,134,136,138,139,141,142,143,144,145,146,147,148,150,151,152,153,154,157,158,159,160,161,162,163,168,169,171,172,173,174,175,176,177,178,179,181,186,189,190,191,192,193,194,196,199,203,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,227,228,229,231,232,233,234,236,238,239,242,243,245,247,249,250,252,253,254,255,256,257,258,259,260,261,262,263,265,266,269,270,271,272,273,274,275,276,277,278,279,280,284,295,296,298,299,300,301,302,303,305,306,308,309,312,313,314,315,316,320,321,327,328,329,330,331,332,333,335,337,338,339,343,344,345,346,347,349,352,353,354,356,358,360,361,362,363,374,378,381,382,383,384,385,386,387,389,391,392,393,397,398,400,401,402,404,406,407,408,411,415,422,423,424,425,431,432,433,434,435,436,437,438,439,441,442,443,444,445,447,454,455,456,457,458,459,460,461,462,463,466,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,485,486,487,488,490,493,494,495,496,497,498,500,501,502,503,504,505,506,507,509,510,511,514,518,519,520,521,522,523,524,525,526,527,528,529,531,536,537,538,540,541,542,543,544,545,546,547,548,549,552,553,554,555,557,558,559,560,564,565,566,571,572,573,576,577,578,579,580,581,584,585,586,587,588,589,590,591,592,593,594,595,597,598,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,616,617,618,622,623,624,625,627,629,630,631,632,636,637,638,639,640,641,643,645,650,651,652,653,654,655,656,657,658,659,662,667,671,674,677,678,679,680,681,682,683,685,691,696,697,698,699,700,701,706,708,709,710,711,712,713,714,715,721,722,724])">0 &amp; 1174</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,1175,[207,619,653])">0 &amp; 1175</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,1684,[31,32,33,46,55,156,167,267,285,286,289,292,293,297,326,364,366,380,394,395,416,417,418,508,626,628,633,634,647,648,649,664,665,666])">0 &amp; 1684</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,1696,[31,32,33,46,47,55,156,167,267,285,286,289,292,293,297,326,364,366,380,394,395,416,417,418,508,626,628,633,634,647,648,649,664,665,666])">0 &amp; 1696</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,1699,[0,3,5,6,30,34,35,36,37,39,40,42,44,48,51,52,53,56,60,62,63,71,81,82,83,95,96,98,101,103,104,106,107,112,113,114,121,127,130,132,142,143,144,147,148,152,154,159,160,171,173,175,181,186,190,199,206,207,211,214,215,216,218,223,236,239,245,253,277,298,314,315,329,332,333,339,382,383,384,385,386,393,433,442,443,444,457,461,463,469,472,474,475,485,486,493,495,496,505,519,542,559,572,576,577,581,584,590,595,605,614,617,625,627,641,654,655,658,659,678,679,680,709,713,722])">0 &amp; 1699</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,2133,[1,31,32,33,46,47,55,64,86,87,88,89,90,91,92,116,117,155,156,164,165,166,167,170,182,183,185,187,188,195,197,224,230,248,267,268,285,286,289,292,293,297,326,341,350,364,366,367,372,373,380,394,395,416,417,418,428,429,446,450,451,465,508,517,561,568,575,620,626,628,633,634,647,648,649,664,665,666,675,704,718])">0 &amp; 2133</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,2800,[9,11,12,16,23,31,32,33,46,47,55,86,88,89,90,91,92,93,116,156,164,165,166,167,183,184,185,187,188,195,198,224,225,248,267,268,281,285,286,289,290,292,293,297,324,326,341,342,348,350,355,364,366,368,369,370,372,376,380,394,395,396,405,409,415,416,417,418,427,428,429,446,450,465,467,489,500,508,516,517,532,563,568,569,575,599,619,620,626,628,633,634,644,647,648,649,651,664,665,666,667,684,689,690,715,717,718])">0 &amp; 2800</button>
                        <button type="button" class="btn btn-default" style="background-color:#ff7f6e"
                            onclick = "highlightroute(0,3495,[1,9,11,12,13,16,17,19,23,24,26,28,31,32,33,46,47,55,64,86,88,89,90,91,92,93,116,117,135,137,149,155,156,164,165,166,167,170,182,183,184,185,187,188,195,197,198,224,225,226,230,242,248,251,267,268,279,281,282,285,286,289,290,292,293,294,297,309,323,324,325,326,336,340,341,342,348,350,355,357,364,366,367,368,369,370,371,372,373,375,376,380,387,388,394,395,396,405,409,410,413,415,416,417,418,419,427,428,429,446,450,451,464,465,467,483,489,500,508,516,517,532,535,539,561,563,568,569,575,599,619,620,626,628,633,634,644,647,648,649,650,651,664,665,666,667,675,684,687,689,690,704,715,717,718,720])">0 &amp; 3495</button>
                    </div>

                    <div class="row">
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(42,0,[8,10,14,45,56,73,74,75,76,78,79,129,140,200,201,202,204,205,288,317,452,453,485,642,703])">42 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(49,0,[3,5,6,36,39,40,42,44,49,51,52,62,65,70,80,94,108,113,114,118,122,124,130,131,132,133,144,154,160,169,175,181,192,206,209,211,215,218,253,260,263,274,328,358,400,433,445,459,469,494,505,522,528,536,540,555,559,572,577,584,595,607,608,609,612,617,618,629,653,654,657,679,721])">49 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(94,0,[3,41,53,62,67,68,69,72,80,110,111,130,134,138,139,141,207,273,298,402,476,477,478,479,480,481,482,486,505,514,582,591,592,593,636,637,638,640,672,673])">94 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(100,0,[0,2,3,4,5,6,30,34,35,36,37,39,40,42,44,45,48,49,51,52,53,56,57,58,60,61,62,63,66,67,68,69,70,71,72,77,80,81,84,94,96,98,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,118,121,126,128,130,131,132,133,134,138,141,143,145,147,148,150,152,154,159,160,161,162,169,171,172,173,174,175,181,186,192,194,199,206,207,208,211,213,214,216,217,218,219,232,233,245,247,258,261,262,272,273,275,277,296,298,310,311,312,314,315,320,329,333,338,339,356,358,362,382,383,384,385,386,398,400,430,433,435,436,441,442,443,444,457,458,459,460,469,470,472,474,475,476,477,478,479,480,481,482,485,486,493,494,496,505,514,519,520,525,536,541,542,546,547,555,572,576,577,581,582,584,587,590,591,592,593,595,605,608,609,618,624,625,630,636,637,643,645,654,655,657,658,659,668,679,698,699,700,701,709,712])">100 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(135,0,[32,89,156,185,292,394,451,508,517,575,626,628,633,648])">135 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(138,0,[52])">138 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(153,0,[86,89,183,187,364,380,451,575,648,665])">153 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(159,0,[31,32,33,55,87,88,89,91,92,149,156,164,167,185,187,188,197,198,248,285,292,293,364,380,417,428,451,508,517,532,575,626,628,633,648,649,666,704])">159 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(179,0,[2,3,5,6,30,34,35,36,37,39,40,42,44,48,49,51,52,53,57,60,62,70,71,81,94,95,96,97,98,99,101,102,103,104,105,106,113,114,120,126,130,132,142,143,144,145,146,147,148,150,153,154,157,158,159,161,169,172,173,174,175,177,178,181,186,193,196,208,211,212,213,214,215,216,217,218,219,223,227,236,237,253,258,259,260,261,262,263,272,273,275,276,277,298,314,315,316,320,329,333,334,337,338,339,346,347,358,363,378,382,383,384,385,386,393,402,433,442,443,444,457,458,459,460,461,469,470,472,475,485,486,495,496,521,522,523,524,525,527,529,536,540,541,543,545,546,547,555,556,572,576,577,578,584,587,590,594,595,606,608,609,611,613,617,618,625,627,629,630,632,643,645,653,655,657,658,659,678,679,680,700,701,709,713,714,722])">179 &amp; 0</button>

                    </div>
                    <div class="row">

                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(543,0,[2,3,5,6,30,34,36,37,39,40,42,48,49,51,52,53,56,58,62,70,80,81,94,95,98,99,104,105,113,114,120,122,127,130,133,144,146,147,148,150,154,158,160,161,173,175,177,181,186,199,206,207,208,209,211,212,213,214,216,253,260,261,262,272,273,276,306,314,327,333,337,338,339,344,346,347,383,385,386,400,433,435,436,442,444,472,485,486,494,505,519,521,522,524,542,546,547,555,557,572,576,578,590,595,605,606,608,612,613,627,654,658,709,714])">543 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(1174,0,[0,2,3,5,6,12,30,35,37,39,40,42,49,51,52,62,71,81,101,105,119,132,134,136,144,148,150,168,177,186,191,192,206,207,208,213,216,220,221,253,263,276,277,278,337,339,374,386,398,400,401,406,408,411,422,436,438,443,447,460,461,520,521,540,541,543,546,555,566,577,578,579,584,589,594,595,604,614,618,627,679,680])">1174 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(1696,0,[31,267])">1696 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(1699,0,[3,62,173,627])">1699 &amp; 0</button>
                        <button type="button" class="btn btn-default" style="background-color:#FFC200"
                                 onclick="highlightroute(2133,0,[46,86,91,92,167,182,183,187,285,286,380,575,665,666,704])">2133 &amp; 0</button>
                    </div>
                    <div class="row">
                        <button type="button" class="btn btn-default" style="background-color:#FFFACD "
                                onclick="highlightroute(1606,5952,[438])">1606 &amp; 5952</button>
                        <button type="button" class="btn btn-default" style="background-color:#EEE8AA "
                                onclick="highlightroute(3181,9075,[0,2,3,4,5,6,7,11,12,16,18,19,20,21,22,23,24,25,26,27,28,29,30,34,35,36,37,39,40,42,44,48,49,51,52,53,57,58,59,60,61,62,65,66,67,68,70,71,72,81,82,83,84,85,94,95,96,97,98,99,101,102,103,104,105,106,107,108,110,111,112,113,114,115,118,121,122,125,126,127,130,132,133,134,136,139,141,142,143,144,145,147,148,151,152,154,158,159,160,161,162,163,168,169,171,173,174,175,176,177,179,181,186,190,191,192,193,194,196,199,203,206,207,208,209,211,212,213,214,215,216,217,218,221,229,236,239,240,245,249,250,253,258,259,260,261,269,272,273,274,275,276,277,296,298,299,300,301,302,303,312,314,315,321,328,332,333,338,339,344,345,346,347,351,356,358,361,378,382,383,384,385,386,387,389,393,398,400,401,402,433,435,436,438,439,442,443,444,445,458,459,460,461,463,466,468,469,470,472,475,476,477,478,479,480,481,482,486,487,493,494,495,497,498,500,505,514,520,521,523,524,525,527,528,529,536,540,541,542,543,546,547,548,554,555,559,564,565,571,572,573,576,577,584,587,588,590,591,592,593,594,595,600,605,606,607,608,609,610,611,612,613,614,617,618,625,627,629,630,631,632,636,637,638,639,640,643,645,651,653,654,655,657,658,659,663,671,677,678,679,680,681,682,698,699,700,701,709,713,715,721,722])">3181 &amp; 9075</button>
                        <button type="button" class="btn btn-default" style="background-color:#90EE90 "
                                onclick="highlightroute(3212,64874,[6,10,34,37,39,40,46,52,56,88,89,90,92,116,129,155,182,188,191,198,200,201,205,283,315,317,367,375,417,429,452,465,475,521,532,628,644,675,682,703,718])">3212 &amp; 64874</button>
                        <button type="button" class="btn btn-default" style="background-color:#7FFFD4 "
                                onclick="highlightroute(4063,55994,[4,18,148,584])">4063 &amp; 55994</button>
                        <button type="button" class="btn btn-default" style="background-color:#B0C4DE "
                                onclick="highlightroute(9075,883,[6,35,39,49,253,351,401,540,543,679])">9075 &amp; 883</button>
                        <button type="button" class="btn-primary" onclick="highlightroute(0,159,[428,195,33,46,135,55,561,165,166,182,156,626,628,451,575,293,665,666,394,364,268,294,297,267,517,149,155,92,188])">exception</button>
                    </div>

                </div>
            </div>
        </div>
        <!--<p>
           <button id = "location" class = "btn btn-default" style="margin-top: 5px">submit coordinates</button>
        </p>-->
        <div class="row">
            <h2 id ="vcpstock">&nbsp;&nbsp;    VCPs' view</h2>
            <div id="flowview" class="col-md-12" style="height:600px"></div>
        </div>

        <div class="row">
            <div id="vcptime" class="col-md-12" style = "height:650px"></div>
        </div>

        <div class="row">
            <div id="vcpview" class="col-md-12" style = "height:600px"></div>
        </div>

        <div class="row">
            <div id="serverview" class="col-md-12" style="height:600px"></div>
        </div>
</div>
<script type="text/javascript" src="../static/d3.min.js"></script>
<script type="text/javascript">
    var network;
    var allNodes;
    var allEdges;
    var highlightActive = false;

    var nodesDataset = new vis.DataSet(nodes);
    var edgesDataset = new vis.DataSet(edges);

    $(document).ready(function() {
        $.getJSON('/flowip', function (data) {
            $("#flowview").highcharts("StockChart",{
                rangeSelector: {
                    buttons: [{//定义一组buttons,下标从0开始
                        type: 'day',
                        count: 1,
                        text: '1d'
                    }, {
                        type: 'week',
                        count: 1,
                        text: '1w'
                    }, {
                        type: 'month',
                        count: 1,
                        text: '1m'
                    },{
                        type: 'all',
                        text: 'All'
                    }],
                    selected: 3
                },
                title: {
                    text: 'flow series with time'
                },


                xAxis:{
                    title:{
                        text:'time'
                    },
                    type: 'datetime', //定义x轴上日期的显示格式
                    labels: {
                        formatter: function () {
                            var vDate = new Date(this.value);
                            //alert(this.value);
                            return (vDate.getMonth() + 1) + "." + vDate.getDate()
                                    + ":" + vDate.getHours();
                        },
                        align: 'center'
                    }
                },

                yAxis:{
                    opposite:false,
                    title:{
                        text:'flow'
                    },
                    labels: {
                        step:2,
                        formatter:function(){
                            if(this.value <=500000) {
                                return "<500M";
                            }else if(this.value >500000 && this.value <=1200000) {
                                return "1G";
                            }else {
                                return ">1.2G";
                            }
                        }
                    }
                },
                tooltip: {
                    shared: true,
                    valueSuffix: 'KB',
                    xDateFormat: '%Y-%m-%d, %A'
                },
                plotOptions: {
                    series: {
                        events: {
                            click: function (d) {
                                //console.log(d.point.x)
                                ipsdistributewithtime(d.point.x);
                            }
                        }
                    }
                },

                series: [
                    {
                        data:data,
                        type:'spline'
                    }
                ],
                credits:{
                    enabled:false
                }
            })
        });
        $.getJSON('/vcptime', function (data) {
            $("#vcptime").highcharts("StockChart",{
                rangeSelector: {
                    buttons: [{//定义一组buttons,下标从0开始
                        type: 'day',
                        count: 1,
                        text: '1d'
                    }, {
                        type: 'week',
                        count: 1,
                        text: '1w'
                    }, {
                        type: 'month',
                        count: 1,
                        text: '1m'
                    },{
                        type: 'all',
                        text: 'All'
                    }],
                    selected: 3
                },
                title: {
                    text: 'vcp types with time'
                },
                colors:['#CD0074', '#85004B', '#E667AF', '#FF0000', '#A60000',
                        '#FF7373', '#7109AA', '#48036F', '#AD66D5', '#FFAA00',
                        '#A66F00', '#FFD073', '#FFD300', '#A68900', '#FFE773',
                        '#FF7400', '#A64B00', '#FFB273', '#9FEE00', '#679B00',
                        '#C9F76F', '#00CC00', '#008500', '#67E667', '#FFFF00',
                        '#A6A600', '#FFFF73', '#1240AB', '#06266F', '#6C8CD5',
                        '#3914AF', '#200772', '#876ED7', '#009999', '#006363',
                        '#5CCCCC', '#F09BC7', '#523728', '#34403A', '#A8A0A3',
                        '#654951', '#262625'],

                xAxis:{
                    title:{
                        text:'time'
                    },
                    type: 'datetime',
                    labels: {
                        formatter: function () {
                            var vDate = new Date(this.value);
                            //alert(this.value);
                            return vDate.getFullYear() + "-" + (vDate.getMonth() + 1) + "-" + vDate.getDate()
                                    + " " + vDate.getHours();
                        },
                        align: 'center'
                    }
                },

                yAxis:{
                    opposite:false,
                    title:{
                        text:'flow'
                    },
                    labels: {
                        step:2,
                        formatter:function(){
                            if(this.value <=500000) {
                                return "<500M";
                            }else if(this.value >500000 && this.value <=1200000) {
                                return "1G";
                            }else {
                                return ">1.2G";
                            }
                        }
                    }
                },
                tooltip: {
                    shared: true,
                    valueSuffix: 'KB',
                    xDateFormat: "%A, %b %e, %H:%M:%S"
                },
                plotOptions: {
                 series: {
                     stacking: 'normal'
                 }
                },
                legend: {
                    enabled: true,
                    layout: 'horizontal',
                    verticalAlign: 'bottom',
                    shadow: true
                },

                series: [
                    {name: '0 & 0', type: "areaspline", data: data[0]},
                    {name: '0 & 37', type: "areaspline", data: data[1]},
                    {name: '0 & 38', type: "areaspline", data: data[2]},
                    {name: '0 & 42', type: "areaspline", data: data[3]},
                    {name: '0 & 49', type: "areaspline", data: data[4]},
                    {name: '0 & 94', type: "areaspline", data: data[5]},
                    {name: '0 & 100', type: "areaspline", data: data[6]},
                    {name: '0 & 135', type: "areaspline", data: data[7]},
                    {name: '0 & 138', type: "areaspline", data: data[8]},
                    {name: '0 & 153', type: "areaspline", data: data[9]},
                    {name: '0 & 159', type: "areaspline", data: data[10]},
                    {name: '0 & 179', type: "areaspline", data: data[11]},
                    {name: '0 & 543', type: "areaspline", data: data[12]},
                    {name: '0 & 1174', type: "areaspline", data: data[13]},
                    {name: '0 & 1175', type: "areaspline", data: data[14]},
                    {name: '0 & 1684', type: "areaspline", data: data[15]},
                    {name: '0 & 1696', type: "areaspline", data: data[16]},
                    {name: '0 & 1699', type: "areaspline", data: data[17]},
                    {name: '0 & 2133', type: "areaspline", data: data[18]},
                    {name: '0 & 2800', type: "areaspline", data: data[19]},
                    {name: '0 & 3495', type: "areaspline", data: data[20]},
                    {name: '37 & 0', type: "areaspline", data: data[21]},
                    {name: '42 & 0', type: "areaspline", data: data[22]},
                    {name: '49 & 0', type: "areaspline", data: data[23]},
                    {name: '94 & 0', type: "areaspline", data: data[24]},
                    {name: '100 & 0', type: "areaspline", data: data[25]},
                    {name: '135 & 0', type: "areaspline", data: data[26]},
                    {name: '138 & 0', type: "areaspline", data: data[27]},
                    {name: '153 & 0', type: "areaspline", data: data[28]},
                    {name: '159 & 0', type: "areaspline", data: data[29]},
                    {name: '179 & 0', type: "areaspline", data: data[30]},
                    {name: '543 & 0', type: "areaspline", data: data[31]},
                    {name: '1174 & 0', type: "areaspline", data: data[32]},
                    {name: '1606 & 5952', type: "areaspline", data: data[33]},
                    {name: '1696 & 0', type: "areaspline", data: data[34]},
                    {name: '1699 & 0', type: "areaspline", data: data[35]},
                    {name: '2133 & 0', type: "areaspline", data: data[36]},
                    {name: '3181 & 9075', type: "areaspline", data: data[37]},
                    {name: '3212 & 64874', type: "areaspline", data: data[38]},
                    {name: '4063 & 55994', type: "areaspline", data: data[39]},
                    {name: '9075 & 883', type: "areaspline", data: data[40]},
                    {name: '64874 & 3247', type: "areaspline", data: data[41]}
                ],
                navigator:{
                    series:{
                        type: 'spline',
                        data:data[42]
                    }
                },

                credits:{
                    enabled:false
                },

            })
        });
        $.getJSON('/getserverflow', function (data) {
            $("#serverview").highcharts("StockChart",{
                rangeSelector: {
                    buttons: [{//定义一组buttons,下标从0开始
                        type: 'day',
                        count: 1,
                        text: '1d'
                    }, {
                        type: 'week',
                        count: 1,
                        text: '1w'
                    }, {
                        type: 'month',
                        count: 1,
                        text: '1m'
                    },{
                        type: 'all',
                        text: 'All'
                    }],
                    selected: 3
                },
                title: {
                    text: 'host flow with time'
                },


                xAxis:{
                    title:{
                        text:'time'
                    },
                    type: 'datetime', //定义x轴上日期的显示格式
                    labels: {
                        formatter: function () {
                            var vDate = new Date(this.value-8*3600000);
                            //alert(this.value);
                            return (vDate.getMonth() + 1) + "." + vDate.getDate()
                                    + " " + vDate.getHours()+ ":" + vDate.getMinutes()+ ":" + vDate.getSeconds();
                        },
                        align: 'center'
                    }
                },

                yAxis:{
                    opposite:false,
                    title:{
                        text:'flow'
                    },
                    labels: {
                        step:2,
                        formatter:function(){
                            if(this.value <=500000) {
                                return "<500M";
                            }else if(this.value >500000 && this.value <=1200000) {
                                return "1G";
                            }else {
                                return ">1.2G";
                            }
                        }
                    }
                },
                tooltip: {
                    shared: true,
                    valueSuffix: 'KB',
                    xDateFormat: '%A, %b %e, %H:%M:%S'
                },
                plotOptions: {
                    series: {
                        events: {
                            click: function (d) {
                                //console.log(d.point.x)
                                ipsdistributewithtime(d.point.x);
                            }
                        }
                    }
                },

                series: [
                    {
                        data:data,
                        type:'spline'
                    }
                ],
                credits:{
                    enabled:false
                }
            })
        });
    })

    function redrawAll() {
        var container = document.getElementById('mynetwork');
        var options = {
            nodes: {
                shape: 'dot',
                scaling: {
                    min: 10,
                    max: 30,
                    label: {
                        min: 8,
                        max: 30,
                        drawThreshold: 12,
                        maxVisible: 20
                    }
                },
                font: {
                    size: 20,
                    face: 'Tahoma'
                }
            },
            edges: {
                width: 0.05,
                smooth: {
                    type: 'continuous'
                }
            },
            physics:false,
            interaction: {
                tooltipDelay: 200,
                hideEdgesOnDrag: true
            }
        };
        var data = {nodes:nodesDataset, edges:edgesDataset} // Note: data is coming from ./datasources/WorldCup2014.js


        network = new vis.Network(container, data, options);

        allNodes = nodesDataset.get({returnType:"Object"});
        allEdges = edgesDataset.get({returnType:"Object"});
        network.on("click",neighbourhoodHighlight);
    }

    function highlightgroup(groupnum){
        //console.log(allNodes)
        highlightActive = true;
        var selectedNodes = [];
        var i,j;
        var degrees = 2;
        for (var nodeId in allNodes){
           if(allNodes[nodeId].group === groupnum) {
               selectedNodes.push(allNodes[nodeId].id);
           }
           //console.log(nodeId)

            allNodes[nodeId].color = 'rgba(200,200,200,0.5)';

           if (allNodes[nodeId].hiddenLabel === undefined) {
               allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
               allNodes[nodeId].label = undefined;
           }
           //console.log(allNodes)
        }
        //console.log(allNodes)

        var connectedNodes =[]
        for(i in selectedNodes){
            connectedNodes = connectedNodes.concat(network.getConnectedNodes(selectedNodes[i]))
        }
        var allConnectedNodes = [];

        // get the second degree nodes
        for (i = 1; i < degrees; i++) {
            for (j = 0; j < connectedNodes.length; j++) {
                allConnectedNodes = allConnectedNodes.concat(network.getConnectedNodes(connectedNodes[j]));
            }
        }
        // all second degree nodes get a different color and their label back
        for (i = 0; i < allConnectedNodes.length; i++) {
            if(selectedNodes.indexOf(allNodes[allConnectedNodes[i]].id) <0){
               allNodes[allConnectedNodes[i]].color = 'rgba(150,150,150,0.75)';
                if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[allConnectedNodes[i]].label = allNodes[allConnectedNodes[i]].hiddenLabel;
                    allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
                }
            }

        }
        // all first degree nodes get their own color and their label back
        for (i = 0; i < connectedNodes.length; i++) {
            if(selectedNodes.indexOf(allNodes[connectedNodes[i]].id) <0) {
                allNodes[connectedNodes[i]].color = 'rgba(150,150,0.75)';
                if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[connectedNodes[i]].label = allNodes[connectedNodes[i]].hiddenLabel;
                    allNodes[connectedNodes[i]].hiddenLabel = undefined;
                }
            }

        }
        for(i in selectedNodes){
            allNodes[selectedNodes[i]].color = undefined;
            if (allNodes[selectedNodes[i]].hiddenLabel !== undefined) {
                allNodes[selectedNodes[i]].label = allNodes[selectedNodes[i]].hiddenLabel;
                allNodes[selectedNodes[i]].hiddenLabel = undefined;
            }
        }

        for (var edgeId in allEdges){
                    if(allEdges[edgeId].hiddenColor == undefined){
                        allEdges[edgeId].hiddenColor = allEdges[edgeId].color
                    }

                    if(selectedNodes.indexOf(allEdges[edgeId].from)||
                        selectedNodes.indexOf(allEdges[edgeId].to)){
                        allEdges[edgeId].color = undefined;//important
                        allEdges[edgeId].color = {inherit:"from"};
                    }
                    else{
                        allEdges[edgeId].color = "rgba(200,200,200,0.5)";
                    }
         }

        var updateArray = [];
        for (nodeId in allNodes) {
            if (allNodes.hasOwnProperty(nodeId)) {
                updateArray.push(allNodes[nodeId]);
            }
        }
        nodesDataset.update(updateArray);

        updateArray = []
        for (edgeId in allEdges) {
            if (allEdges.hasOwnProperty(edgeId)) {
                updateArray.push(allEdges[edgeId]);
            }
        }
        edgesDataset.update(updateArray);
        //console.log(selectedNodes)
        //console.log(allNodes)
        //console.log(connectedNodes)
        //console.log(allConnectedNodes)
    }

    function highlightroute(vp,vc,routenodelist){
        highlightActive = true;
        var selectedNodes = [];
        var i,j;
        for (var nodeId in allNodes){
           if(routenodelist.indexOf(allNodes[nodeId].id) >= 0) {
               selectedNodes.push(allNodes[nodeId].id);
           }

            allNodes[nodeId].color = 'rgba(200,200,200,0.5)';

           if (allNodes[nodeId].hiddenLabel === undefined) {
               allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
               allNodes[nodeId].label = undefined;
           }
        }

        for(i in selectedNodes){
            allNodes[selectedNodes[i]].color = undefined;
            if (allNodes[selectedNodes[i]].hiddenLabel !== undefined) {
                allNodes[selectedNodes[i]].label = allNodes[selectedNodes[i]].hiddenLabel;
                allNodes[selectedNodes[i]].hiddenLabel = undefined;
            }
        }

         for (var edgeId in allEdges){
                    if(allEdges[edgeId].hiddenColor == undefined){
                        allEdges[edgeId].hiddenColor = allEdges[edgeId].color
                    }

                    if(selectedNodes.indexOf(allEdges[edgeId].from)||
                        selectedNodes.indexOf(allEdges[edgeId].to)){
                        allEdges[edgeId].color = undefined;//important
                        allEdges[edgeId].color = {inherit:"from"};
                    }
                    else{
                        allEdges[edgeId].color = "rgba(200,200,200,0.5)";
                    }
         }

        var updateArray = [];
        for (nodeId in allNodes) {
            if (allNodes.hasOwnProperty(nodeId)) {
                updateArray.push(allNodes[nodeId]);
            }
        }
        nodesDataset.update(updateArray);

        updateArray = []
        for (edgeId in allEdges) {
            if (allEdges.hasOwnProperty(edgeId)) {
                updateArray.push(allEdges[edgeId]);
            }
        }
        edgesDataset.update(updateArray);
        drawVCP(vp,vc);



    }

    function drawVCP(vp,vc){

        $.getJSON('/datavcp',{
            vp:vp,
            vc:vc,
            now: new Date().getTime()
        },function(data){
            $("#vcpview").highcharts("StockChart",{
             rangeSelector: {
                buttons: [{//定义一组buttons,下标从0开始
                    type: 'day',
                    count: 1,
                    text: '1d'
                }, {
                    type: 'week',
                    count: 1,
                    text: '1w'
                }, {
                    type: 'month',
                    count: 1,
                    text: '1m'
                },{
                    type: 'all',
                    text: 'All'
                }],
                selected: 3
            },
                title: {
                text: vp+" & "+vc+' flow series with time'
            },
                legend: {
                    enabled: true,
                    layout: 'horizontal',
                    verticalAlign: 'bottom',
                    shadow: true
                },

            xAxis:{
                title:{
                text:'time'
                },
                type: 'datetime', //定义x轴上日期的显示格式
                labels: {
                    formatter: function () {
                        var vDate = new Date(this.value);
                        //alert(this.value);
                        return vDate.getFullYear() + "-" + (vDate.getMonth() + 1) + "-" + vDate.getDate()
                                + " " + vDate.getHours();
                    },
                    align: 'center'
                }
            },

            yAxis:{
                opposite:false,
                title:{
                text:'flow'
                },
                labels: {
                    step:2,
                    formatter:function(){
                        if(this.value <=500000) {
                            return "<500M";
                        }else if(this.value >500000 && this.value <=1200000) {
                            return "1G";
                        }else {
                            return ">1.2G";
                        }
                    }
                }
            },
            tooltip: {
                shared: true,
                valueSuffix: 'KB',
                xDateFormat: '%Y-%m-%d, %A'
            },
            plotOptions: {
                 series: {
                     stacking: 'normal',
                     events: {
                         click: function (d) {
                             console.log(d.point.x)
                         }
                     }
                 }
            },

            series: [
                    {name: 'rpc', type: "areaspline", data: data[1]},
                    {name: 'exe', type: "areaspline", data: data[2]},
                    {name: 'picture', type: "areaspline", data: data[3]},
                    {name: 'rtfs', type: "areaspline", data: data[4]},
                    {name: 'rars', type: "areaspline", data: data[5]},
                    {name: 'htmls', type: "areaspline", data: data[6]},
                    {name: 'cs', type: "areaspline", data: data[7]},
                    {name: 'unknown', type: "areaspline", data: data[8]}
            ],
            navigator:{
                series:{
                    type: 'spline',
                    data:data[0]
                }
            },
            credits:{
                enabled:false
            }
            })
        })
    }

    function neighbourhoodHighlight(params) {
        //console.log(params)
        //console.log(allNodes)
        // if something is selected:
        if (params.nodes.length > 0) {
            highlightActive = true;
            var i,j;
            var selectedNode = params.nodes[0];
            //console.log(selectedNode)
            var degrees = 2;

            // mark all nodes as hard to read.
            for (var nodeId in allNodes) {
                //console.log(nodeId)
                allNodes[nodeId].color = 'rgba(200,200,200,0.5)';
                if (allNodes[nodeId].hiddenLabel === undefined) {
                    allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
                    allNodes[nodeId].label = undefined;
                }
                //console.log(allNodes)
            }
            var connectedNodes = network.getConnectedNodes(selectedNode);
            //console.log(connectedNodes)
            var allConnectedNodes = [];

            // get the second degree nodes
            for (i = 1; i < degrees; i++) {
                for (j = 0; j < connectedNodes.length; j++) {
                    allConnectedNodes = allConnectedNodes.concat(network.getConnectedNodes(connectedNodes[j]));
                }
            }
            //console.log(allConnectedNodes)

            // all second degree nodes get a different color and their label back
            for (i = 0; i < allConnectedNodes.length; i++) {
                allNodes[allConnectedNodes[i]].color = 'rgba(150,150,150,0.75)';
                if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[allConnectedNodes[i]].label = allNodes[allConnectedNodes[i]].hiddenLabel;
                    allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
                }
            }

            // all first degree nodes get their own color and their label back
            for (i = 0; i < connectedNodes.length; i++) {
                allNodes[connectedNodes[i]].color = undefined;
                if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[connectedNodes[i]].label = allNodes[connectedNodes[i]].hiddenLabel;
                    allNodes[connectedNodes[i]].hiddenLabel = undefined;
                }
            }

            // the main node gets its own color and its label back.
            allNodes[selectedNode].color = undefined;
            if (allNodes[selectedNode].hiddenLabel !== undefined) {
                allNodes[selectedNode].label = allNodes[selectedNode].hiddenLabel;
                allNodes[selectedNode].hiddenLabel = undefined;
            }

            for (var edgeId in allEdges){
                    if(allEdges[edgeId].hiddenColor == undefined){
                        allEdges[edgeId].hiddenColor = allEdges[edgeId].color
                    }

                    if(allEdges[edgeId].from == selectedNode ||
                        allEdges[edgeId].to == selectedNode ){
                        allEdges[edgeId].color = undefined;//important
                        allEdges[edgeId].color = {inherit:"from"};
                    }
                    else{
                        allEdges[edgeId].color = "rgba(200,200,200,0.5)";
                    }


            }

        }
        else if (highlightActive === true) {
            // reset all nodes
            for (var nodeId in allNodes) {
                allNodes[nodeId].color = undefined;
                if (allNodes[nodeId].hiddenLabel !== undefined) {
                    allNodes[nodeId].label = allNodes[nodeId].hiddenLabel;
                    allNodes[nodeId].hiddenLabel = undefined;
                }
            }

            for (var edgeId in allEdges){
                allEdges[edgeId].color = undefined
                allEdges[edgeId].color = allEdges[edgeId].hiddenColor
                allEdges[edgeId].hiddenColor=undefined
            }
            highlightActive = false
        }

        // transform the object into an array
        var updateArray = [];
        for (nodeId in allNodes) {
            if (allNodes.hasOwnProperty(nodeId)) {
                updateArray.push(allNodes[nodeId]);
            }
        }
        nodesDataset.update(updateArray);
        updateArray = []
        for (edgeId in allEdges) {
            if (allEdges.hasOwnProperty(edgeId)) {
                updateArray.push(allEdges[edgeId]);
            }
        }
        edgesDataset.update(updateArray);
    }

    var searchip = function() {
        var ip = $('#ipsearch').val()
        //console.log(ip)
        if (ip != '') {
            highlightActive = true;
            var i,j;
            var selectedNode;
            var degrees = 2;

            // mark all nodes as hard to read.
            for (var nodeId in allNodes) {
                //console.log(nodeId)
                allNodes[nodeId].color = 'rgba(200,200,200,0.5)';
                if (allNodes[nodeId].label == ip) {
                    selectedNode = nodeId
                }
                if (allNodes[nodeId].hiddenLabel === undefined) {
                    allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
                    allNodes[nodeId].label = undefined;
                }

                //console.log(allNodes)
            }
            var connectedNodes = network.getConnectedNodes(selectedNode);
            //console.log(connectedNodes)
            var allConnectedNodes = [];

            // get the second degree nodes
            for (i = 1; i < degrees; i++) {
                for (j = 0; j < connectedNodes.length; j++) {
                    allConnectedNodes = allConnectedNodes.concat(network.getConnectedNodes(connectedNodes[j]));
                }
            }
            //console.log(allConnectedNodes)

            // all second degree nodes get a different color and their label back
            for (i = 0; i < allConnectedNodes.length; i++) {
                allNodes[allConnectedNodes[i]].color = 'rgba(150,150,150,0.75)';
                if (allNodes[allConnectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[allConnectedNodes[i]].label = allNodes[allConnectedNodes[i]].hiddenLabel;
                    allNodes[allConnectedNodes[i]].hiddenLabel = undefined;
                }
            }

            // all first degree nodes get their own color and their label back
            for (i = 0; i < connectedNodes.length; i++) {
                allNodes[connectedNodes[i]].color = undefined;
                if (allNodes[connectedNodes[i]].hiddenLabel !== undefined) {
                    allNodes[connectedNodes[i]].label = allNodes[connectedNodes[i]].hiddenLabel;
                    allNodes[connectedNodes[i]].hiddenLabel = undefined;
                }
            }

            // the main node gets its own color and its label back.
            allNodes[selectedNode].color = undefined;
            if (allNodes[selectedNode].hiddenLabel !== undefined) {
                allNodes[selectedNode].label = allNodes[selectedNode].hiddenLabel;
                allNodes[selectedNode].hiddenLabel = undefined;
            }
        }
        else if (highlightActive === true) {
            // reset all nodes
            for (var nodeId in allNodes) {
                allNodes[nodeId].color = undefined;
                if (allNodes[nodeId].hiddenLabel !== undefined) {
                    allNodes[nodeId].label = allNodes[nodeId].hiddenLabel;
                    allNodes[nodeId].hiddenLabel = undefined;
                }
            }
            highlightActive = false
        }

        // transform the object into an array
        var updateArray = [];
        for (nodeId in allNodes) {
            if (allNodes.hasOwnProperty(nodeId)) {
                updateArray.push(allNodes[nodeId]);
            }
        }
        nodesDataset.update(updateArray);
    }

    function ipsdistributewithtime(time){
        $.getJSON('/ipsdistributewithtime',{
            time:time,
            now: new Date().getTime()
        },function(data){
            highlightips(data);
        })
    }

    function highlightips(routenodelist){
        highlightActive = true;
        var selectedNodes = [];
        var i,j;
        for (var nodeId in allNodes){
           if(routenodelist.indexOf(allNodes[nodeId].id) >= 0) {
               selectedNodes.push(allNodes[nodeId].id);
           }

            allNodes[nodeId].color = 'rgba(200,200,200,0.5)';

           if (allNodes[nodeId].hiddenLabel === undefined) {
               allNodes[nodeId].hiddenLabel = allNodes[nodeId].label;
               allNodes[nodeId].label = undefined;
           }
        }

        for(i in selectedNodes){
            allNodes[selectedNodes[i]].color = undefined;
            if (allNodes[selectedNodes[i]].hiddenLabel !== undefined) {
                allNodes[selectedNodes[i]].label = allNodes[selectedNodes[i]].hiddenLabel;
                allNodes[selectedNodes[i]].hiddenLabel = undefined;
            }
        }

         for (var edgeId in allEdges){
                    if(allEdges[edgeId].hiddenColor == undefined){
                        allEdges[edgeId].hiddenColor = allEdges[edgeId].color
                    }

                    if(selectedNodes.indexOf(allEdges[edgeId].from)||
                        selectedNodes.indexOf(allEdges[edgeId].to)){
                        allEdges[edgeId].color = undefined;//important
                        allEdges[edgeId].color = {inherit:"from"};
                    }
                    else{
                        allEdges[edgeId].color = "rgba(200,200,200,0.5)";
                    }
         }

        var updateArray = [];
        for (nodeId in allNodes) {
            if (allNodes.hasOwnProperty(nodeId)) {
                updateArray.push(allNodes[nodeId]);
            }
        }
        nodesDataset.update(updateArray);

        updateArray = []
        for (edgeId in allEdges) {
            if (allEdges.hasOwnProperty(edgeId)) {
                updateArray.push(allEdges[edgeId]);
            }
        }
        edgesDataset.update(updateArray);
    }
    redrawAll()
</script>
<script src = "../static/jquery-1.12.3.min.js"></script>
<script src = "../static/js/bootstrap.min.js"></script>
<script type = "text/javascript">
    $(function() {
        function submit_form(e) {
            var locationnodes = network["body"].nodes
            //console.log(network)
            var location = []
            var arr = Object.keys(locationnodes)
            //console.log(arr.length)
            for(var i =0;i<arr.length;i++)
            {
                location.push({"x":locationnodes[i].x,"y":locationnodes[i].y})
            }
            //console.log(location)
            $.getJSON('/datalocation', {
                        data: JSON.stringify(location)
                    },
                    function (data) {
                        alert(data.result)
                    });
        };
        $("#location").bind("click", submit_form);
    });

</script>


<script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../static/highstock.js"></script>
</body>
</html>